Strike Latino 2 â€“ Standings + Juegos de Hoy
PequeÃ±a app en Flask que muestra la tabla de posiciones y el reporte de â€œJuegos jugados HOY (hora Chile)â€ para una liga de MLB The Show.
Se apoya en un script que consulta la API pÃºblica de theshow.com, normaliza datos y evita duplicados (IDs alternos de jugadores y/o duplicados de la API).

âœ¨ CaracterÃ­sticas
Tabla de posiciones ordenada por Pts â†’ W â†’ L.

Reporte de Juegos jugados HOY con hora convertida a America/Santiago.

Switch de modo:

DEBUG: â€œhoyâ€ = dÃ­a calendario (00:00â€“23:59), imprime capturas y genera JSON en out/.

ONLINE: â€œhoyâ€ = dÃ­a deportivo (06:00â€“05:59), silencioso y sin dumps.

Manejo de IDs alternativos por jugador (suma sin duplicar):

Mapea cuentas alternas en FETCH_ALIASES.

DeduplicaciÃ³n por id + deduplicaciÃ³n canÃ³nica (home, away, score, minuto) para â€œJuegos de hoyâ€.

ğŸ“ Estructura
cpp
Copiar cÃ³digo
.
â”œâ”€ app.py
â”œâ”€ standings_cascade_points_desc.py
â”œâ”€ templates/
â”‚  â””â”€ index.html
â”œâ”€ static/
â”‚  â””â”€ styles.css
â”œâ”€ requirements.txt
â”œâ”€ Procfile
â””â”€ .gitignore
ğŸ”§ ConfiguraciÃ³n clave (en standings_cascade_points_desc.py)
Modo de ejecuciÃ³n
python
Copiar cÃ³digo
# "DEBUG" o "ONLINE"
MODE = "ONLINE"
DEBUG: Ãºtil en local; muestra resÃºmenes y crea JSON (carpeta out/).

ONLINE: recomendado en producciÃ³n; â€œJuegos de hoyâ€ usa 06:00â€“05:59 y no genera dumps.

Liga (jugadores y equipos)
python
Copiar cÃ³digo
LEAGUE_ORDER = [
    ("THELSURICATO", "Mets"),
    # ...
    ("Tu_Pauta2000", "Braves"),
]
Una sola fila por equipo. Si el mismo participante usa otras cuentas, NO agregues otra fila; usa FETCH_ALIASES.

IDs alternativos (sumar sin duplicar)
python
Copiar cÃ³digo
FETCH_ALIASES = {
    "Tu_Pauta2000": ["Lachi_1991"],  # Braves: tambiÃ©n juega con esta cuenta
    # "OtroPrincipal": ["Alias1", "Alias2"],
}
El script descargarÃ¡ pÃ¡ginas del usuario principal y sus alias, las unirÃ¡, y deduplicarÃ¡ por id antes de computar W/L.

Miembros de liga (filtro de pertenencia)
Se construye automÃ¡ticamente a partir de LEAGUE_ORDER + FETCH_ALIASES.
Puedes aÃ±adir equivalencias histÃ³ricas si aplican:

python
Copiar cÃ³digo
LEAGUE_USERS.update({"AiramReynoso_", "Yosoyreynoso_"})
Rango temporal y pÃ¡ginas
python
Copiar cÃ³digo
SINCE = datetime(2025, 8, 30)    # fecha mÃ­nima de juegos a considerar
PAGES = (1, 2, 3, 4, 5)          # pÃ¡ginas a leer por usuario/alias
ğŸ–¥ï¸ Correr en local (Windows)
Crear carpeta y copiar archivos:

bat
Copiar cÃ³digo
mkdir C:\liga_local
cd C:\liga_local
Entorno virtual e instalaciÃ³n:

bat
Copiar cÃ³digo
py -3 -m venv .venv
.\.venv\Scripts\activate.bat
python -m pip install --upgrade pip
python -m pip install -r requirements.txt
En Windows se necesita tzdata (ya estÃ¡ en requirements.txt) para la zona horaria â€œAmerica/Santiagoâ€.

Ejecutar:

bat
Copiar cÃ³digo
python app.py
Abrir en el navegador:

http://127.0.0.1:5000

http://127.0.0.1:5000/api/debug_counts (verifica rows_count y games_today_count)

Si el listado de â€œJuegos de hoyâ€ aparece vacÃ­o tras medianoche, usa MODE="ONLINE" (dÃ­a deportivo 06:00â€“05:59).

ğŸŒ Despliegue en Render
GitHub: inicializa repo y sube:

bat
Copiar cÃ³digo
git init
git add .
git commit -m "Primera versiÃ³n lista para Render"
git branch -M main
git remote add origin https://github.com/TU_USUARIO/strike-latino-2.git
git push -u origin main
Render â†’ New â†’ Web Service â†’ conecta tu repo.

Environment: Python

Build Command: pip install -r requirements.txt

Start Command:

bash
Copiar cÃ³digo
gunicorn app:app --workers 2 --threads 4 --timeout 120 --bind 0.0.0.0:$PORT
Activa Auto Deploys si quieres que se redeploye con cada git push.

Prueba la URL pÃºblica:

/ â†’ pÃ¡gina

/api/debug_counts â†’ verificaciÃ³n rÃ¡pida

ğŸ§ª Endpoints Ãºtiles
/ â€“ Renderiza la tabla y â€œJuegos de hoyâ€.

/api/debug_counts â€“ JSON con:

rows_count (nÃºmero de filas en la tabla)

games_today_count (items en el reporte â€œhoyâ€)

first_rows_keys (campos de la primera fila)

ğŸ§  CÃ³mo evitamos duplicados
W/L por equipo (compute_team_record_for_user):

Se descargan juegos del usuario principal y sus alias (FETCH_ALIASES).

Se une todo y se pasa por dedup_by_id (misma id â†’ un solo juego).

Se filtra liga + fecha + que participe el equipo correcto y que ambos sean miembros (o CPU+miembro).

Juegos de hoy:

Descargamos de todos (principales + alias).

DeduplicaciÃ³n doble:

Por id (si la API duplica el mismo juego en distintos historiales).

Por clave canÃ³nica: (home, away, home_runs, away_runs, YYYY-MM-DD HH:MM), por si alguna vez la id tambiÃ©n se repite o varÃ­a.

ğŸ› ï¸ Troubleshooting
Tabla vacÃ­a:

Revisa SINCE (debe ser <= a la fecha real de tus primeros juegos).

Verifica LEAGUE_ORDER (usernames exactos) y FETCH_ALIASES.

No aparecen â€œJuegos de hoyâ€:

Si ejecutas despuÃ©s de medianoche, usa MODE="ONLINE" (06:00â€“05:59).

Confirma que ambos usernames del partido figuran como miembros (principal o alias).

Lentitud / rate limit:

Reduce PAGES a (1, 2) si no necesitas profundidad.

Considera agregar cachÃ© en app.py (puedo pasarte snippet si lo necesitas).

ğŸ“œ Requisitos y Procfile
requirements.txt:

nginx
Copiar cÃ³digo
flask
requests
tzdata
gunicorn
Procfile:

less
Copiar cÃ³digo
web: gunicorn app:app --workers 2 --threads 4 --timeout 120 --bind 0.0.0.0:$PORT
.gitignore (sugerido):

csharp
Copiar cÃ³digo
.venv/
__pycache__/
*.pyc
out/
.vscode/
.idea/
âœ… Checklist antes de publicar
MODE = "ONLINE" en producciÃ³n.

FETCH_ALIASES actualizado (por ejemplo Tu_Pauta2000 â†’ ["Lachi_1991"]).

SINCE correcto para el torneo.

PAGES ajustado a tu necesidad/rendimiento.

Render levanta sin errores y /api/debug_counts responde.

Licencia
Este proyecto se distribuye tal cual para uso en tu liga. AÃ±ade una licencia si planeas abrirlo pÃºblicamente.